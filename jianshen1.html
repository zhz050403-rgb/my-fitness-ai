<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>AI æ™ºèƒ½ç§æ•™ Pro</title>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        :root { --p: #1a73e8; --bg: #f8fafc; }
        body { font-family: system-ui, sans-serif; background: var(--bg); padding: 20px; display: flex; justify-content: center; }
        .box { background: white; padding: 25px; border-radius: 16px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); width: 100%; max-width: 550px; }
        h1 { text-align: center; color: var(--p); margin-bottom: 20px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .form-group { margin-bottom: 12px; }
        label { display: block; font-size: 0.85rem; font-weight: bold; margin-bottom: 4px; color: #444; }
        input, select, textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 14px; }
        textarea { height: 60px; resize: none; }
        .btn-group { display: flex; gap: 10px; margin-top: 15px; }
        button { flex: 1; padding: 14px; background: var(--p); color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }
        #saveBtn { background: #34a853; display: none; }
        #output { margin-top: 25px; border-top: 2px solid #eee; padding-top: 15px; line-height: 1.7; font-size: 15px; }
        .loading { text-align: center; color: #666; font-style: italic; animation: blink 1.5s infinite; }
        @keyframes blink { 0% { opacity: 0.3; } 50% { opacity: 1; } 100% { opacity: 0.3; } }
    </style>
</head>
<body>

<div class="box">
    <h1>ğŸ’ª æ·±åº¦å®šåˆ¶å¥èº«è®¡åˆ’</h1>
    
    <div class="grid">
        <div class="form-group"><label>æ€§åˆ«</label><select id="gender"><option>å¥³</option><option>ç”·</option></select></div>
        <div class="form-group"><label>å¹´é¾„</label><input type="number" id="age" value="25"></div>
        <div class="form-group"><label>èº«é«˜ (cm)</label><input type="number" id="h" value="151"></div>
        <div class="form-group"><label>ä½“é‡ (kg)</label><input type="number" id="w" value="42"></div>
    </div>

    <div class="form-group">
        <label>èº«ä½“çŠ¶æ€ (å¦‚ï¼šä¹…åè…°ç–¼ã€ç»å¸¸ä½è¡€ç³–)</label>
        <textarea id="status" placeholder="å†™å†™ä½ çš„èº«ä½“å°ç§˜å¯†..."></textarea>
    </div>
    <div class="form-group">
        <label>è¿åŠ¨ä¹ æƒ¯ (å¦‚ï¼šåŸºæœ¬ä¸è¿åŠ¨ã€ä»¥å‰ç»ƒè¿‡èˆ)</label>
        <textarea id="habit" placeholder="æè¿°ä¸‹ä½ å¹³æ—¶çš„æ´»åŠ¨é‡..."></textarea>
    </div>
    
    <div class="form-group">
        <label>ç†æƒ³èº«æ</label>
        <select id="dream">
            <option>é©¬ç”²çº¿å°‘å¥³ (ç´§è‡´çº¿æ¡æ„Ÿ)</option>
            <option>è¶…æ¨¡ä½“å‹ (ä¿®é•¿åŒ€ç§°)</option>
            <option>å…ƒæ°”è¿åŠ¨é£ (æƒ³é•¿ç‚¹è‚‰ï¼Œæ›´å¥åº·)</option>
        </select>
    </div>

    <div class="btn-group">
        <button onclick="askAI()">ç”Ÿæˆæˆ‘çš„è®¡åˆ’</button>
        <button id="saveBtn" onclick="saveToTxt()">ä¿å­˜åˆ°æœ¬åœ°</button>
    </div>

    <div id="output"></div>
</div>

<script>
    async function askAI() {
        const out = document.getElementById('output');
        const saveBtn = document.getElementById('saveBtn');
        out.innerHTML = "<p class='loading'>æ•™ç»ƒæ­£åœ¨æŸ¥é˜…èµ„æ–™å¹¶è®¡ç®—å»ºè®®ï¼Œè¯·ç¨å€™...</p>";
        saveBtn.style.display = "none";

        // âš ï¸ è¯·åœ¨è¿™é‡Œå¡«å…¥ä½ æ–°å¤åˆ¶çš„ API KEY
        const KEY = "AIzaSyC_9B_ze95qDMD3FIls6lRpScUCvuiGd0g"; 
        
        // ä½¿ç”¨å›ºå®šçš„ URL åœ°å€
        const URL = "https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=" + KEY;

        const info = {
            g: document.getElementById('gender').value,
            a: document.getElementById('age').value,
            h: document.getElementById('h').value,
            w: document.getElementById('w').value,
            s: document.getElementById('status').value || "æ— ç‰¹æ®Šä¼¤ç—…",
            hb: document.getElementById('habit').value || "æ— è¿åŠ¨ä¹ æƒ¯",
            d: document.getElementById('dream').value
        };

        const prompt = `ä½ æ˜¯ä¸€ä½ä¸“ä¸šç§æ•™ã€‚è¯·æ ¹æ®ä»¥ä¸‹ä¿¡æ¯å®šåˆ¶æ–¹æ¡ˆï¼š
        ç”¨æˆ·ï¼š${info.g}ï¼Œ${info.a}å²ï¼Œ${info.h}cm/${info.w}kgã€‚èº«ä½“ï¼š${info.s}ã€‚ä¹ æƒ¯ï¼š${info.hb}ã€‚ç›®æ ‡ï¼š${info.d}ã€‚
        è¾“å‡º Markdown æ ¼å¼ï¼š1. BMI åˆ†æä¸ä½“å‹å®šä½ã€‚2. ä¸€å‘¨è¯¦ç»†è®¡åˆ’ï¼ˆå¸¦åŠ¨ä½œç»„æ•°ï¼‰ã€‚3. é¥®é£Ÿé»‘çº¢æ¦œã€‚4. ç»™æ–°æ‰‹å°ç™½çš„ä¸€å¥è¯ã€‚`;

        try {
            const resp = await fetch(URL, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
            });
            const data = await resp.json();
            
            if (data.candidates && data.candidates[0].content) {
                const text = data.candidates[0].content.parts[0].text;
                out.innerHTML = marked.parse(text);
                saveBtn.style.display = "block";
            } else {
                throw new Error("API å“åº”å¼‚å¸¸");
            }
        } catch (e) {
            out.innerHTML = "<p style='color:red'>âŒ ç”Ÿæˆå¤±è´¥ã€‚å¸¸è§åŸå› ï¼š<br>1. API Key æœªæ¿€æ´»ï¼ˆéœ€ç­‰ 5 åˆ†é’Ÿï¼‰<br>2. è¯·ç¡®ä¿ä»£ç†è½¯ä»¶å¼€å¯äº†â€œå…¨å±€æ¨¡å¼â€</p>";
        }
    }

    function saveToTxt() {
        const text = document.getElementById('output').innerText;
        const blob = new Blob([text], {type: "text/plain"});
        const a = document.createElement("a");
        a.href = window.URL.createObjectURL(blob);
        a.download = "æˆ‘çš„å¥èº«è®¡åˆ’.txt";
        a.click();
    }
</script>
</body>
</html>