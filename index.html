<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI Coach Pro | èº«ä½“å»ºæ¨¡è¯„ä¼°</title>
    <script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/marked/4.0.2/marked.min.js"></script>
    <style>
        :root { --accent: #6366f1; --glass: rgba(255, 255, 255, 0.12); }
        
        body { 
            margin: 0; padding: 0; min-height: 100vh;
            font-family: -apple-system, "PingFang SC", sans-serif;
            background: linear-gradient(-45deg, #0f172a, #1e1b4b, #312e81, #1e1b4b);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            overflow: hidden; color: white;
        }
        @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

        .quiz-container {
            width: 90%; max-width: 420px; min-height: 550px;
            background: var(--glass); backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 32px; padding: 35px 25px;
            box-sizing: border-box; display: flex; flex-direction: column; position: relative;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
        }

        /* è¿›åº¦æ¡ */
        #progress-wrap { position: absolute; top: 0; left: 0; width: 100%; height: 6px; display: none; }
        #progress { height: 100%; background: #fff; border-radius: 32px 32px 0 0; transition: width 0.4s; }

        .page { display: none; flex-direction: column; height: 100%; animation: slideIn 0.4s ease forwards; }
        .page.active { display: flex; }
        @keyframes slideIn { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } }

        .inst-box { background: rgba(255,255,255,0.08); padding: 12px; border-radius: 12px; color: #ccc; font-size: 0.85rem; margin-bottom: 20px; border-left: 4px solid var(--accent); line-height: 1.5; }
        h2 { font-size: 1.3rem; margin-bottom: 25px; text-align: center; line-height: 1.4; }

        .auth-input {
            width: 100%; padding: 18px; border-radius: 16px; border: none;
            background: rgba(255, 255, 255, 0.95); font-size: 1.3rem;
            text-align: center; margin-bottom: 20px; box-sizing: border-box;
            font-weight: bold; color: #1e1b4b; letter-spacing: 2px;
        }

        .option-btn {
            background: rgba(255, 255, 255, 0.15); border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 16px; border-radius: 16px; color: white;
            margin-bottom: 12px; cursor: pointer; transition: 0.2s;
            font-size: 1rem; text-align: center;
        }
        .option-btn:active { transform: scale(0.96); background: rgba(255,255,255,0.3); }

        .disclaimer-text { font-size: 0.65rem; color: rgba(255,255,255,0.4); text-align: center; margin-top: 15px; width: 90%; pointer-events: none; }

        #result-page { 
            display: none; width: 100vw; height: 100vh; background: #fff;
            position: fixed; inset: 0; z-index: 200; padding: 25px; overflow-y: auto; box-sizing: border-box;
        }
        #result-content { color: #333; line-height: 1.8; }
        #result-content table { width: 100%; border-collapse: collapse; display: block; overflow-x: auto; margin: 15px 0; }
        #result-content td, #result-content th { border: 1px solid #eee; padding: 10px; font-size: 0.8rem; }
        .res-footer { font-size: 0.7rem; color: #aaa; text-align: center; margin-top: 30px; border-top: 1px solid #eee; padding-top: 15px; }

        .loading-box { text-align: center; padding: 50px 0; }
        .spinner { width: 40px; height: 40px; border: 4px solid rgba(255,255,255,0.3); border-top-color: #fff; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 20px; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div class="quiz-container" id="main-container">
    <div id="progress-wrap"><div id="progress"></div></div>

    <div id="page-auth" class="page active">
        <h2>èº«ä»½æˆæƒéªŒè¯</h2>
        <p style="text-align:center; opacity:0.7; font-size:0.85rem; margin-bottom:25px;">è¯·è¾“å…¥æ¿€æ´»ç å¼€å¯ 20 é¡¹èº«ä½“å»ºæ¨¡æµ‹éªŒ</p>
        <input type="text" id="authCode" class="auth-input" placeholder="è¾“å…¥10ä½æˆæƒç " maxlength="10">
        <div class="option-btn" style="background:var(--accent); border:none; font-weight:bold;" onclick="verifyCode()">ç«‹å³æ¿€æ´»</div>
    </div>

    <div id="page-quiz" class="page">
        <div id="quiz-flow"></div>
    </div>

    <div id="page-loading" class="page">
        <div class="loading-box">
            <div class="spinner"></div>
            <p>ğŸ’ æˆæƒæˆåŠŸï¼</p>
            <p style="font-size:0.8rem; opacity:0.7;">ä¸“å®¶ AI æ­£åœ¨æ ¹æ®æ‚¨çš„æµ‹éªŒæ•°æ®<br>è§„åˆ’ä¸´åºŠçº§å™¨æ¢°çº æ­£æ–¹æ¡ˆ...</p>
        </div>
    </div>
</div>

<div class="disclaimer-text">aiçš„å›ç­”æœªå¿…æ­£ç¡®æ— è¯¯ï¼Œä»…ä¾›å‚è€ƒï¼Œå¦‚æœ‰ä¸é€‚è¯·ç«‹å³å°±åŒ»</div>

<div id="result-page">
    <div id="result-content"></div>
    <div class="res-footer">aiçš„å›ç­”æœªå¿…æ­£ç¡®æ— è¯¯ï¼Œä»…ä¾›å‚è€ƒï¼Œå¦‚æœ‰ä¸é€‚è¯·ç«‹å³å°±åŒ»</div>
    <button onclick="location.reload()" style="width:100%; padding:15px; border-radius:12px; background:#1e1b4b; color:white; margin-top:20px; border:none; font-weight:bold;">é‡æ–°æµ‹éªŒ</button>
</div>

<script>
    // æ–¹æ¡ˆ 1ï¼š20 ä¸ªä¸“ä¸šæµ‹è¯•ä¸è‡ªæ£€é¢˜ç›®
    const questions = [
        { inst: "æµ‹è¯• 1ï¼šè¯·é—­çœ¼å•è…¿ç«™ç«‹ 10 ç§’ã€‚", q: "å“ªä¸€ä¾§æ›´æ™ƒï¼Ÿ", opts: ["å·¦ä¾§æ›´æ™ƒ", "å³ä¾§æ›´æ™ƒ", "éƒ½ç«™ä¸ç¨³", "ä¸¤ä¾§å¾ˆç¨³"] },
        { inst: "æµ‹è¯• 2ï¼šåŒæ‰‹å‰è…°ç¼“æ…¢æ·±è¹²ã€‚", q: "ä¸‹è¹²æ—¶å“ªé‡Œæœ€å…ˆå—é™ï¼Ÿ", opts: ["å¤§è…¿å‰ä¾§", "è†ç›–å“åŠ¨/å‹åŠ›", "è…°éƒ¨å‘é…¸", "å±è‚¡å‘ç´§"] },
        { inst: "æµ‹è¯• 3ï¼šè¯·åšå¹³æ¿æ”¯æ’‘æ’‘åˆ°åŠ›ç«­ã€‚", q: "å“ªé‡Œæœ€å…ˆæ„Ÿåˆ°ç–²åŠ³/é…¸ç—›ï¼Ÿ", opts: ["è‚šå­(è…¹éƒ¨)", "åè…°é…¸ç—›", "è‚©è†€æ‰‹è‡‚", "å¤§è…¿ä¸€ç›´åœ¨æŠ–"] },
        { inst: "æµ‹è¯• 4ï¼šæ·±å¸ä¸€å£æ°”è§‚å¯Ÿèº«ä½“ã€‚", q: "å¸æ°”æ—¶å“ªé‡Œæ‰©å¼ æœ€æ˜æ˜¾ï¼Ÿ", opts: ["è‚©è†€ä¸Šè€¸", "è‚šå­é¡¶èµ·", "è‚‹éª¨ä¾§å‘æ’‘å¼€", "èƒ¸å£æ†‹é—·"] },
        { inst: "æµ‹è¯• 5ï¼šåŸåœ°è¸æ­¥ 30 ç§’åœä¸‹ã€‚", q: "ä½å¤´çœ‹ï¼Œè„šå°–çš„æŒ‡å‘ï¼Ÿ", opts: ["æ˜æ˜¾å¤–å…«", "æ˜æ˜¾å†…å…«", "ä¸€æ­£ä¸€æ­ª", "åŸºæœ¬æŒ‡å‘å‰æ–¹"] },
        // è‡ªæ£€å¼•å¯¼ (åŸºäºæ–¹æ¡ˆ1)
        { inst: "è‡ªæ£€ 1ï¼šä¾§èº«çœ‹é•œå­æˆ–ç…§ç‰‡ã€‚", q: "è€³å‚æ˜¯å¦åœ¨è‚©è†€æ­£ä¸Šæ–¹ï¼Ÿ", opts: ["å¤´å‰ä¼¸æ˜æ˜¾", "åŸºæœ¬åœ¨æ­£ä¸Šæ–¹", "è·³è¿‡æ­¤è‡ªæ£€"] },
        
        { inst: "è‡ªæ£€ 2ï¼šè‡ªç„¶ç«™ç«‹çœ‹æŒå¿ƒæœå‘ã€‚", q: "è§‚å¯Ÿåœ†è‚©ç¨‹åº¦ï¼š", opts: ["æŒå¿ƒå®Œå…¨æœå", "æŒå¿ƒæœå‘å¤§è…¿", "è·³è¿‡æ­¤è‡ªæ£€"] },
        
        { inst: "è‡ªæ£€ 3ï¼šé å¢™ç«™ç«‹å°è¯•åè…°å¡æ‰‹ã€‚", q: "è…°æ¤æ›²åº¦çŠ¶æ€ï¼š", opts: ["ç¼éš™å¾ˆå¤§(æ‹³å¤´)", "å¹³å¡ä¸€æŒ(æ­£å¸¸)", "å‡ ä¹æ²¡ç¼(æ‰å¹³)", "è·³è¿‡"] },
        
        { inst: "æ„Ÿè§‰ 1ï¼šæ™¨èµ·åçš„èº«ä½“æ„Ÿå®˜ã€‚", q: "åˆšç¡é†’æ—¶ä½ çš„æ„Ÿè§‰ï¼Ÿ", opts: ["è…°èƒŒåƒµç¡¬", "æµ‘èº«è½»æ¾", "å…³èŠ‚å‘æœ¨", "å“ªå“ªéƒ½ä¸å¯¹"] },
        { inst: "æ„Ÿè§‰ 2ï¼šä¹…ååçš„ç–¼ç—›å€¾å‘ã€‚", q: "å 1 å°æ—¶åå“ªé‡Œæœ€éš¾å—ï¼Ÿ", opts: ["å±è‚¡æ·±å¤„ç–¼", "è…°æ¤æ­£ä¸­é…¸", "è„–å­è½¬ä¸åŠ¨", "è…¹è‚¡æ²Ÿå‘ç´§"] },
        // è¡¥å……è¿½é—®å‡‘è¶³ 20
        { inst: "è¿½é—® 11", q: "ä¸Šæ¥¼æ¢¯æ—¶è†ç›–æ˜¯å¦æœ‰å£°éŸ³ï¼Ÿ", opts: ["ç»å¸¸å“ä¸”ç–¼", "å¶å°”å“ä¸ç–¼", "å®Œå…¨æ²¡å£°éŸ³"] },
        { inst: "è¿½é—® 12", q: "å¹³æ—¶ç©¿é‹ï¼Œå“ªä¾§é‹åº•ç£¨æŸé‡ï¼Ÿ", opts: ["å·¦ä¾§", "å³ä¾§", "ä¸¤è¾¹å·®ä¸å¤š"] },
        { inst: "è¿½é—® 13", q: "æ˜¯å¦ç»å¸¸ä¹ æƒ¯æ€§å•è¾¹ä¾§ç¡ï¼Ÿ", opts: ["é•¿æœŸå·¦ä¾§", "é•¿æœŸå³ä¾§", "ä»°å§è¾ƒå¤š", "è¶´ç¡"] },
        { inst: "è¿½é—® 14", q: "å•æ‰‹æ‘¸å¯¹ä¾§è‚©èƒ›éª¨ï¼Œå“ªè¾¹éš¾ï¼Ÿ", opts: ["å·¦æ‰‹éš¾", "å³æ‰‹éš¾", "éƒ½å·®ä¸å¤š", "éƒ½èƒ½æ‘¸åˆ°"] },
        { inst: "è¿½é—® 15", q: "è…¹éƒ¨å‘åŠ›æ—¶æ˜¯å¦ä¼šæ†‹æ°”ï¼Ÿ", opts: ["ä¹ æƒ¯æ†‹æ°”", "è‡ªç„¶å‘¼å¸", "æ²¡æ³¨æ„è¿‡"] },
        { inst: "è¿½é—® 16", q: "ç”Ÿç†æœŸæˆ–åŠ³ç´¯æ—¶è…°ç—›ä½ç½®ï¼Ÿ", opts: ["åè…°ä¸¤ä¾§", "å°¾éª¨é™„è¿‘", "æ•´ä¸ªä¸‹è…°éƒ¨"] },
        { inst: "è¿½é—® 17", q: "æ›¾ç»æœ‰è¿‡ä¸¥é‡çš„è„šè¸æ‰­ä¼¤å—ï¼Ÿ", opts: ["å·¦è„šæœ‰è¿‡", "å³è„šæœ‰è¿‡", "åŒè„šéƒ½æœ‰è¿‡", "ä»æœªæœ‰è¿‡"] },
        { inst: "è¿½é—® 18", q: "è¿åŠ¨åç¬¬äºŒå¤©è†ç›–ä¼šè‚¿èƒ€å—ï¼Ÿ", opts: ["ç»å¸¸ä¼š", "å¶å°”ä¼š", "ä»æœªæœ‰è¿‡"] },
        { inst: "è¿½é—® 19", q: "ä½ çš„æ‰§è¡Œä¹ æƒ¯å€¾å‘ï¼Ÿ", opts: ["è¿½æ±‚å¤§é‡é‡", "è¿½æ±‚è‚Œè‚‰æ„Ÿè§‰", "å®ŒæˆåŠ¨ä½œå°±è¡Œ"] },
        { inst: "è¿½é—® 20", q: "ç›®å‰çš„è®­ç»ƒé¢‘ç‡ï¼Ÿ", opts: ["æ¯å‘¨1-2æ¬¡", "æ¯å‘¨3-4æ¬¡", "å‡ ä¹ä¸ç»ƒ", "æ¯å¤©éƒ½ç»ƒ"] }
    ];

    let currentQ = 0;
    let answers = [];
    let savedCode = "";

    function verifyCode() {
        const code = document.getElementById('authCode').value.trim().toUpperCase();
        const isValid = (s) => s.length === 10 && s.includes("K") && (s.charCodeAt(3) - s.charCodeAt(7) === 3);
        
        if(!isValid(code)) { alert("âŒ æ¿€æ´»ç æ ¼å¼é”™è¯¯"); return; }
        const used = JSON.parse(localStorage.getItem('used_codes') || '[]');
        if(used.includes(code)) { alert("âš ï¸ æ­¤ç å·²æ¿€æ´»"); return; }

        savedCode = code;
        document.getElementById('page-auth').classList.remove('active');
        document.getElementById('page-quiz').classList.add('active');
        document.getElementById('progress-wrap').style.display = 'block';
        renderQ();
    }

    function renderQ() {
        const qData = questions[currentQ];
        const flow = document.getElementById('quiz-flow');
        flow.innerHTML = `
            <div class="inst-box">${qData.inst}</div>
            <h2>${qData.q}</h2>
        `;
        qData.opts.forEach(o => {
            const b = document.createElement('div');
            b.className = 'option-btn';
            b.innerText = o;
            b.onclick = () => handleAns(o);
            flow.appendChild(b);
        });
        document.getElementById('progress').style.width = `${((currentQ+1)/questions.length)*100}%`;
    }

    function handleAns(o) {
        if(!o.includes("è·³è¿‡")) answers.push(`Q${currentStep+1}[${questions[currentQ].q}]: ${o}`);
        if(currentQ < questions.length - 1) {
            currentQ++;
            renderQ();
        } else {
            submit();
        }
    }

    async function submit() {
        document.getElementById('page-quiz').classList.remove('active');
        document.getElementById('page-loading').classList.add('active');

        // ğŸ’¡ æ›¿æ¢ä½ çš„ API KEY
        const KEY = "sk-xxxxxxxxxxxxxxxxxxxxxxxx"; 

        try {
            const res = await fetch("https://api.deepseek.com/chat/completions", {
                method: "POST",
                headers: { "Content-Type": "application/json", "Authorization": `Bearer ${KEY}` },
                body: JSON.stringify({
                    model: "deepseek-chat",
                    messages: [
                        {role: "system", content: "ä½ æ˜¯ä¸€ä½20å¹´ç»éªŒç”Ÿç‰©åŠ›å­¦ä¸“å®¶ã€‚åŸºäºç”¨æˆ·åŠ¨ä½œåé¦ˆå’Œè‡ªæ£€å‹¾é€‰ï¼Œå…ˆæŒ‡å‡ºæ½œåœ¨ä»£å¿ç‚¹ï¼ˆå¦‚éª¨ç›†å‰å€¾/åœ†è‚©ç­‰ï¼‰ï¼Œå†ç»™30å¤©å™¨æ¢°çº æ­£è®¡åˆ’ã€‚ä¸¥ç¦å¾’æ‰‹åŠ¨ä½œï¼Œç”¨Markdownè¡¨æ ¼å±•ç¤ºã€‚å¼€å¤´åŠ ä¸€æ®µä¸“ä¸šè¯Šæ–­ã€‚"},
                        {role: "user", content: answers.join('\n')}
                    ]
                })
            });
            const data = await res.json();
            
            const used = JSON.parse(localStorage.getItem('used_codes') || '[]');
            used.push(savedCode);
            localStorage.setItem('used_codes', JSON.stringify(used));

            document.getElementById('main-container').style.display = 'none';
            document.querySelector('.disclaimer-text').style.display = 'none';
            document.getElementById('result-page').style.display = 'block';
            document.getElementById('result-content').innerHTML = marked.parse(data.choices[0].message.content);
        } catch(e) {
            alert("API å“åº”å¤±è´¥ï¼Œè¯·æ£€æŸ¥ Key æˆ–ç½‘ç»œã€‚");
            location.reload();
        }
    }
</script>
</body>
</html>
