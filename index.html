<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI ä¸“ä¸šä½“æ€ä¸èº«æç®¡ç†ç³»ç»Ÿ</title>
    <script src="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/marked/4.0.2/marked.min.js"></script>
    <style>
        :root { --primary: #007aff; --text: #1d1d1f; --bg-red: #d12d6c; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; padding: 0; background: var(--bg-red); font-family: -apple-system, system-ui, sans-serif; display: flex; justify-content: center; align-items: flex-end; min-height: 100vh; overflow: hidden; }
        
        .main-card { width: 100%; height: 98vh; max-width: 600px; background: #ffffff; border-radius: 28px 28px 0 0; padding: 40px 24px; box-shadow: 0 -10px 40px rgba(0,0,0,0.1); display: flex; flex-direction: column; position: relative; overflow-y: auto; }
        
        .header { font-size: 1.5rem; font-weight: 700; color: var(--text); margin-bottom: 20px; }
        .prog-bg { width: 100%; height: 2px; background: #f2f2f7; margin-bottom: 30px; }
        .prog-fill { height: 100%; background: var(--primary); transition: width 0.4s ease; width: 5%; }

        .input-group { margin-bottom: 20px; }
        .input-group label { display: block; font-size: 0.85rem; color: #86868b; margin-bottom: 8px; font-weight: 600; }
        .input-group input, .input-group select { width: 100%; border: 1px solid #e5e5e7; padding: 15px; border-radius: 12px; font-size: 1rem; outline: none; background: #f9f9fb; }

        .question-text { font-size: 1.3rem; font-weight: 600; color: var(--text); line-height: 1.4; margin-bottom: 30px; }
        .opt-btn { background: #fff; border: 1px solid #e5e5e7; padding: 18px; border-radius: 16px; font-size: 1rem; font-weight: 500; cursor: pointer; margin-bottom: 12px; text-align: left; transition: 0.2s; }
        .opt-btn:active { background: #f5f5f7; border-color: var(--primary); }

        .auth-page { text-align: center; padding-top: 30px; }
        .auth-input { width: 100%; border: none; background: #f2f2f7; padding: 20px; border-radius: 16px; font-size: 1.4rem; font-weight: 700; text-align: center; letter-spacing: 3px; margin: 30px 0; }

        .black-btn { width: 100%; background: #000; color: #fff; border: none; padding: 20px; border-radius: 16px; font-size: 1.1rem; font-weight: 600; cursor: pointer; margin-top: auto; }
        #result-view { display: none; position: fixed; inset: 0; background: white; z-index: 2000; padding: 30px 24px; overflow-y: auto; }
        .loader { display: none; text-align: center; color: #86868b; margin: 20px 0; }
    </style>
</head>
<body>

<div class="main-card" id="app">
    <div id="nav">
        <div class="header" id="title">åŸºç¡€æ•°æ®é‡‡é›†</div>
        <div class="prog-bg"><div class="prog-fill" id="prog-fill"></div></div>
    </div>

    <div id="step-base">
        <div class="input-group"><label>æ€§åˆ«</label><select id="base-sex"><option>å¥³</option><option>ç”·</option></select></div>
        <div class="input-group"><label>å¹´é¾„</label><input type="number" id="base-age" placeholder="è¯·è¾“å…¥å¹´é¾„"></div>
        <div class="input-group"><label>èº«é«˜ (cm)</label><input type="number" id="base-height" placeholder="å¦‚ 165"></div>
        <div class="input-group"><label>ä½“é‡ (kg)</label><input type="number" id="base-weight" placeholder="å¦‚ 55"></div>
        <div class="input-group"><label>ç›®æ ‡èº«æ</label><select id="base-goal"><option>å‡è„‚ç˜¦èº«</option><option>ä½“æ€çº æ­£ï¼ˆæ°”è´¨æå‡ï¼‰</option><option>å¢è‚Œå¡‘å½¢</option><option>äº§åä¿®å¤</option></select></div>
        <button class="black-btn" onclick="startQuiz()">è¿›å…¥ä½“æ€æ·±åº¦æµ‹è¯„</button>
    </div>

    <div id="step-quiz" style="display:none;">
        <div id="q-display" class="question-text">åŠ è½½ä¸­...</div>
        <div id="opts-box" style="display:flex; flex-direction:column;"></div>
    </div>

    <div id="step-auth" style="display:none;">
        <div class="auth-page">
            <span style="font-size:3rem;">ğŸ”’</span>
            <div class="question-text" style="margin-top:20px;">è¯„ä¼°å·²å®Œæˆ</div>
            <p style="color:#86868b;">è¯·è¾“å…¥ 15 ä½æˆæƒç ä»¥è§£é”æ·±åº¦åˆ†ææŠ¥å‘Š</p>
            <input type="text" id="activationCode" class="auth-input" placeholder="è¯·è¾“å…¥æˆæƒç ">
            <button class="black-btn" onclick="validate()">è§£é” AI æ·±åº¦æŠ¥å‘Š</button>
            <div id="loading" class="loader">æ­£åœ¨åˆ†æèº«ä½“æ¨¡å‹å¹¶ç”Ÿæˆçº æ­£æ–¹æ¡ˆ...</div>
        </div>
    </div>
</div>

<div id="result-view">
    <div id="report-content" style="line-height:1.8;"></div>
    <button onclick="location.reload()" style="width:100%; padding:15px; border:1px solid #eee; background:#fff; border-radius:12px; margin-top:30px;">é‡æ–°è¯„ä¼°</button>
</div>

<script>
    const DEEP_KEY = "sk-d37975a862d84a7580adf1759cee3a1a"; 

    const questions = [
        { q: "ä¾§èº«çœ‹ï¼Œè€³å‚æ˜¯å¦æ˜æ˜¾åœ¨è‚©è†€å‰æ–¹ï¼Ÿ", opts: ["æ˜¯ï¼ˆå¤´å‰ä¼¸ï¼‰", "å¦ï¼ˆæ­£å¸¸ï¼‰", "è½»å¾®å‰ä¼¸"] },
        { q: "è‡ªç„¶ç«™ç«‹ï¼Œæ‰‹æŒå¿ƒçš„é»˜è®¤æœå‘ï¼Ÿ", opts: ["å‘åï¼ˆåœ†è‚©ï¼‰", "å‘å¤§è…¿ä¾§ï¼ˆæ­£å¸¸ï¼‰", "ç•¥å¾®å‘å"] },
        { q: "è§‚å¯Ÿé”éª¨å½¢çŠ¶ï¼Ÿ", opts: ["æ˜æ˜¾çš„ V å‹", "å¹³ç›´ä¸€å­—å‹", "çœ‹ä¸æ¸…/ä¸æ˜æ˜¾"] },
        { q: "æ˜¯å¦æœ‰æ˜æ˜¾çš„é«˜ä½è‚©ï¼Ÿ", opts: ["å·¦è‚©é«˜", "å³è‚©é«˜", "åŸºæœ¬é½å¹³"] },
        { q: "åè„‘å‹ºæ˜¯å¦èƒ½è½»æ¾è´´å¢™ï¼Ÿ", opts: ["è´´ä¸åˆ°", "è½»æ¾è´´åˆ°", "è´´åˆ°ä½†è„–å­ç´§"] },
        { q: "è…°éƒ¨ä¸å¢™é¢çš„ç©ºéš™ï¼Ÿ", opts: ["ä¸€ä¸ªæ‹³å¤´ï¼ˆéª¨ç›†å‰å€¾é£é™©ï¼‰", "ä¸€ä¸ªæ‰‹æŒï¼ˆæ­£å¸¸ï¼‰", "å®Œå…¨è´´å¢™ï¼ˆéª¨ç›†åå€¾é£é™©ï¼‰"] },
        { q: "å°è…¹æ˜¯å¦å¼‚å¸¸å‰å‡¸ï¼ˆå³ä¾¿ä¸èƒ–ï¼‰ï¼Ÿ", opts: ["éå¸¸æ˜æ˜¾", "è½»å¾®", "æ²¡æœ‰"] },
        { q: "è£¤å¤´æ˜¯å¦ç»å¸¸ä¸€è¾¹é«˜ä¸€è¾¹ä½ï¼Ÿ", opts: ["ç»å¸¸æ˜¯", "å¦", "æ²¡æ³¨æ„è¿‡"] },
        { q: "å¹¶è„šä¸‹è¹²ï¼Œè„šåè·Ÿèƒ½è¸©å®å—ï¼Ÿ", opts: ["ä¸èƒ½ï¼ˆå¾€åå€’ï¼‰", "è½»æ¾è¸©å®", "å‹‰å¼ºè¸©å®"] },
        { q: "é‹åº•ç£¨æŸä½ç½®ï¼Ÿ", opts: ["å¤–ä¾§å¤šï¼ˆè¶³å¤–ç¿»ï¼‰", "å†…ä¾§å¤šï¼ˆå¹³è¶³é£é™©ï¼‰", "å‡åŒ€"] },
        { q: "ä¹…ååå“ªé‡Œæœ€é…¸ç—›ï¼Ÿ", opts: ["é¢ˆéƒ¨", "è…°æ¤", "è‡€è…¿"] },
        { q: "æ˜¯å¦æœ‰ç¿˜äºŒéƒè…¿ä¹ æƒ¯ï¼Ÿ", opts: ["ç»å¸¸", "å¶å°”", "ä¸ç¿˜"] },
        { q: "åŒæ‰‹åå‹¾èƒ½æŒ‡å°–ç›¸æ‰£å—ï¼Ÿ", opts: ["ä¸èƒ½", "å‹‰å¼º", "è½»æ¾"] },
        { q: "è§‚å¯ŸèƒŒéƒ¨è‚©èƒ›éª¨ï¼Ÿ", opts: ["æ˜æ˜¾å‡¸èµ·ï¼ˆç¿¼çŠ¶è‚©ï¼‰", "å¹³æ•´", "è½»å¾®å‡¸èµ·"] },
        { q: "å‘¼å¸æ—¶èƒ¸å£èµ·ä¼æ˜æ˜¾å—ï¼Ÿ", opts: ["éå¸¸æ˜æ˜¾ï¼ˆæµ…å‘¼å¸ï¼‰", "è…¹éƒ¨èµ·ä¼å¤š", "ä¸¤è€…å¹³è¡¡"] },
        { q: "èµ°è·¯æ˜¯å¦ç»å¸¸è¸¢åˆ°è„šè¸æˆ–ç»Šå€’ï¼Ÿ", opts: ["ç»å¸¸", "å¶å°”", "ä»æœª"] },
        { q: "è½¬åŠ¨è„–å­æ˜¯å¦æœ‰å“å£°ï¼Ÿ", opts: ["å“å£°å¤§", "æ²¡å“å£°", "å¶å°”å“"] },
        { q: "å•è„šç«™ç«‹é—­çœ¼åšæŒæ—¶é—´ï¼Ÿ", opts: ["å°äº5ç§’", "5-10ç§’", "10ç§’ä»¥ä¸Š"] },
        { q: "æ¯å¤©å¤„ç†ç”µå­äº§å“æ—¶é•¿ï¼Ÿ", opts: ["10h+", "5-10h", "5h-"] },
        { q: "ç°åœ¨çš„ç–¼ç—›æƒ…å†µï¼Ÿ", opts: ["æœ‰æ˜æ˜¾ç—›ç‚¹", "å¶å°”é…¸èƒ€", "æ— ä¸é€‚"] }
    ];

    let currentIdx = 0;
    let answers = [];

    function startQuiz() {
        const h = document.getElementById('base-height').value;
        const w = document.getElementById('base-weight').value;
        if(!h || !w) return alert("è¯·å¡«å†™èº«é«˜ä½“é‡");
        answers.push(`æ€§åˆ«:${document.getElementById('base-sex').value}, å¹´é¾„:${document.getElementById('base-age').value}, èº«é«˜:${h}cm, ä½“é‡:${w}kg, ç›®æ ‡:${document.getElementById('base-goal').value}`);
        document.getElementById('step-base').style.display = 'none';
        document.getElementById('step-quiz').style.display = 'block';
        document.getElementById('title').innerText = "ä½“æ€è‡ªæ£€æµ‹è¯„";
        render();
    }

    function render() {
        const q = questions[currentIdx];
        document.getElementById('q-display').innerText = `${currentIdx + 1}. ${q.q}`;
        document.getElementById('prog-fill').style.width = ((currentIdx + 1) / 20) * 100 + '%';
        const box = document.getElementById('opts-box'); box.innerHTML = '';
        q.opts.forEach(o => {
            const btn = document.createElement('div'); btn.className = 'opt-btn'; btn.innerText = o;
            btn.onclick = () => {
                answers.push(o);
                if(currentIdx < 19) { currentIdx++; render(); } 
                else { 
                    document.getElementById('nav').style.display='none';
                    document.getElementById('step-quiz').style.display='none'; 
                    document.getElementById('step-auth').style.display='block'; 
                }
            };
            box.appendChild(btn);
        });
    }

    async function validate() {
        const code = document.getElementById('activationCode').value;
        const pts = code.split('-');
        if(pts.length !== 2) return alert("æˆæƒç æ ¼å¼é”™è¯¯");
        const s1 = pts[0].split('').reduce((a,b)=>a+b.charCodeAt(0),0);
        const s2 = pts[1].split('').reduce((a,b)=>a+b.charCodeAt(0),0);
        if(s1 !== 543 || s2 !== 618) return alert("æˆæƒç éªŒè¯å¤±è´¥");

        document.getElementById('loading').style.display = 'block';
        try {
            const res = await fetch("https://api.deepseek.com/chat/completions", {
                method: "POST",
                headers: { "Content-Type": "application/json", "Authorization": `Bearer ${DEEP_KEY}` },
                body: JSON.stringify({
                    model: "deepseek-chat",
                    messages: [
                        {role: "system", content: "ä½ æ˜¯ä¸€ä½ç²¾é€šäººä½“è§£å‰–ä¸è¥å…»å­¦çš„ç§æ•™ã€‚æ ¹æ®èº«é«˜ä½“é‡ä½“æ€æ•°æ®ï¼Œæä¾›Markdownæ ¼å¼æŠ¥å‘Šã€‚åŒ…å«ï¼šBMIè¯„ä»·ã€ä½“æ€è¯Šæ–­ã€30å¤©é’ˆå¯¹æ€§è®­ç»ƒã€é¥®é£Ÿå»ºè®®ã€‚"},
                        {role: "user", content: answers.join('; ')}
                    ]
                })
            });
            const data = await res.json();
            document.getElementById('report-content').innerHTML = marked.parse(data.choices[0].message.content);
            document.getElementById('result-view').style.display = 'block';
        } catch(e) { alert("ç½‘ç»œå¼‚å¸¸ï¼Œè¯·æ£€æŸ¥ API æˆ–é‡è¯•"); document.getElementById('loading').style.display = 'none'; }
    }
</script>
</body>
</html>
